<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/gpsd-dev/2011-March/index.html" >
   <LINK REL="made" HREF="mailto:gpsd-dev%40lists.berlios.de?Subject=Re%3A%20%5BGpsd-dev%5D%20%5BGpsd-commit-watch%5D%20Project%20gpsd%20at%20BerliOS%20branch%2C%0A%20master%2C%20updated.%20release-2.95-1015-g299c211&In-Reply-To=%3CAANLkTinejRRLzJKk_DGyWkheRBKq%2Beho5rLwWtD-6gVk%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008788.html">
   <LINK REL="Next"  HREF="008798.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211</H1>
    <B>Chris Kuethe</B> 
    <A HREF="mailto:gpsd-dev%40lists.berlios.de?Subject=Re%3A%20%5BGpsd-dev%5D%20%5BGpsd-commit-watch%5D%20Project%20gpsd%20at%20BerliOS%20branch%2C%0A%20master%2C%20updated.%20release-2.95-1015-g299c211&In-Reply-To=%3CAANLkTinejRRLzJKk_DGyWkheRBKq%2Beho5rLwWtD-6gVk%40mail.gmail.com%3E"
       TITLE="[Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211">chris.kuethe at gmail.com
       </A><BR>
    <I>Sat Mar 12 00:39:30 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="008788.html">[Gpsd-dev] Breaking up the packet sniffer
</A></li>
        <LI>Next message: <A HREF="008798.html">[Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8790">[ date ]</a>
              <a href="thread.html#8790">[ thread ]</a>
              <a href="subject.html#8790">[ subject ]</a>
              <a href="author.html#8790">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>according to git bisect, this commit breaks my build.

gpspacket.c:8:20: error: Python.h: No such file or directory
gpspacket.c:13: error: expected '=', ',', ';', 'asm' or
'__attribute__' before '*' token
gpspacket.c:15: error: expected '=', ',', ';', 'asm' or
'__attribute__' before '*' token
gpspacket.c: In function 'gpsd_report':
gpspacket.c:20: error: 'PyObject' undeclared (first use in this function)
gpspacket.c:20: error: (Each undeclared identifier is reported only once
gpspacket.c:20: error: for each function it appears in.)
gpspacket.c:20: error: 'args' undeclared (first use in this function)
gpspacket.c:21: error: 'va_list' undeclared (first use in this function)
gpspacket.c:21: error: expected ';' before 'ap'
gpspacket.c:25: error: 'report_callback' undeclared (first use in this function)
gpspacket.c:29: error: 'ErrorObject' undeclared (first use in this function)
gpspacket.c:33: error: 'ap' undeclared (first use in this function)
gpspacket.c: At top level:
gpspacket.c:45: error: expected '=', ',', ';', 'asm' or
'__attribute__' before 'Lexer_Type'
gpspacket.c:48: error: expected specifier-qualifier-list before 'PyObject_HEAD'
gpspacket.c:53: error: expected ')' before '*' token
gpspacket.c: In function 'Lexer_init':
gpspacket.c:69: error: 'LexerObject' has no member named 'lexer'
gpspacket.c: At top level:
gpspacket.c:73: error: expected '=', ',', ';', 'asm' or
'__attribute__' before '*' token
gpspacket.c:94: error: expected '=', ',', ';', 'asm' or
'__attribute__' before '*' token
gpspacket.c:109: error: expected '=', ',', ';', 'asm' or
'__attribute__' before 'Lexer_methods'
gpspacket.c:117: error: expected '=', ',', ';', 'asm' or
'__attribute__' before '*' token
gpspacket.c:124: error: expected ')' before string constant
gpspacket.c:128: error: expected '=', ',', ';', 'asm' or
'__attribute__' before 'Lexer_Type'
gpspacket.c:177: error: expected '=', ',', ';', 'asm' or
'__attribute__' before '*' token
gpspacket.c:191: error: expected ')' before string constant
gpspacket.c:195: error: expected '=', ',', ';', 'asm' or
'__attribute__' before '*' token
gpspacket.c:223: error: expected '=', ',', ';', 'asm' or
'__attribute__' before 'packet_methods'
gpspacket.c:232: error: expected ')' before string constant
gpspacket.c:245: error: expected '=', ',', ';', 'asm' or
'__attribute__' before 'initpacket'
error: command 'cc' failed with exit status 1


On Wed, Mar 9, 2011 at 13:38, bzed at BerliOS &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">gpsd-dev at lists.berlios.de</A>&gt; wrote:
&gt;<i> This is an automated email from the git hooks/post-receive script. It was
</I>&gt;<i> generated because a ref change was pushed to the repository containing
</I>&gt;<i> the project &quot;Project gpsd at BerliOS&quot;.
</I>&gt;<i>
</I>&gt;<i> The branch, master has been updated
</I>&gt;<i> &#160; &#160; &#160; via &#160;299c211ee46e378c9110f7f7a75d42240af03a47 (commit)
</I>&gt;<i> &#160; &#160; &#160; via &#160;25c5f8a12955e145a25a4c532240eb8557b1ae86 (commit)
</I>&gt;<i> &#160; &#160; &#160; via &#160;fa1d43dcc15e721bff471d9ac7cb75f92a188303 (commit)
</I>&gt;<i> &#160; &#160; &#160;from &#160;2ad88823a86d5c5bda8a6741e7a186762c7f5c30 (commit)
</I>&gt;<i>
</I>&gt;<i> Those revisions listed above that are new to this repository have
</I>&gt;<i> not appeared on any other notification email; so we list those
</I>&gt;<i> revisions in full, below.
</I>&gt;<i>
</I>&gt;<i> - Log -----------------------------------------------------------------
</I>&gt;<i> commit 299c211ee46e378c9110f7f7a75d42240af03a47
</I>&gt;<i> Author: Bernd Zeimetz &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">bernd at bzed.de</A>&gt;
</I>&gt;<i> Date: &#160; Wed Mar 9 22:36:26 2011 +0100
</I>&gt;<i>
</I>&gt;<i> &#160; &#160;Fix out-of-src-directory builds for python.
</I>&gt;<i>
</I>&gt;<i> &#160; &#160;Also ensure that `version` is uptodate in setup.py.
</I>&gt;<i> &#160; &#160;Running `make testregress` still does not work properly if run outside of $srcdir, but at least it runs now.
</I>&gt;<i>
</I>&gt;<i> diff --git a/Makefile.am b/Makefile.am
</I>&gt;<i> index 0a88c95..022fa65a 100644
</I>&gt;<i> --- a/Makefile.am
</I>&gt;<i> +++ b/Makefile.am
</I>&gt;<i> @@ -288,7 +288,7 @@ noinst_SCRIPTS += stamp-python setup.py
</I>&gt;<i>
</I>&gt;<i> &#160;# TODO: &#160;Should the dependency on libgps.la be enforced inside
</I>&gt;<i> &#160;# setup.py? &#160;(See the variable 'needed_files' in setup.py.)
</I>&gt;<i> -stamp-python: gpspacket.c gpsclient.c libgps.la setup.py $(PYTHONMODULES_DIST) $(PYTHONSCRIPTS_DIST)
</I>&gt;<i> +stamp-python: gpspacket.c gpsclient.c libgps.la gpsd.h setup.py $(PYTHONMODULES_DIST) $(PYTHONSCRIPTS_DIST)
</I>&gt;<i> &#160;# Build Python modules and scripts using distutils via setup.py.
</I>&gt;<i> &#160;# We define build-lib and build-scripts as distutils might have been
</I>&gt;<i> &#160;# configured to use different directories, but we want to use the
</I>&gt;<i> @@ -302,12 +302,12 @@ stamp-python: gpspacket.c gpsclient.c libgps.la setup.py $(PYTHONMODULES_DIST) $
</I>&gt;<i> &#160; &#160; &#160; &#160;env version='$(PACKAGE_VERSION)' abs_builddir='$(abs_builddir)' \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;MAKE='$(MAKE)' \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;$(PYTHON) setup.py build \
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-lib '$(srcdir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-scripts '$(srcdir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-lib '$(abs_builddir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-scripts '$(abs_builddir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;--mangenerator '$(XMLPROC)') &amp;&amp; \
</I>&gt;<i> &#160; &#160; &#160; &#160;(cd '$(srcdir)/gps' &amp;&amp; \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;rm -f *.so &amp;&amp; \
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; ln -s ../$(PYTHON_DISTUTILS_LIBDIR)/gps/*.so . ) &amp;&amp; \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; ln -s $(abs_builddir)/$(PYTHON_DISTUTILS_LIBDIR)/gps/*.so . ) &amp;&amp; \
</I>&gt;<i> &#160; &#160; &#160; &#160;mv -f '$@.tmp' '$@'
</I>&gt;<i> &#160;CLEANFILES += stamp-python stamp-python.tmp
</I>&gt;<i> &#160;endif
</I>&gt;<i> @@ -373,10 +373,10 @@ if HAVE_PYTHON
</I>&gt;<i> &#160; &#160; &#160; &#160;env version='$(PACKAGE_VERSION)' abs_builddir='$(abs_builddir)' \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160;MAKE='$(MAKE)' \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;$(PYTHON) setup.py clean \
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-lib '$(srcdir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-scripts '$(srcdir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-lib '$(abs_builddir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-scripts '$(abs_builddir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;--mangenerator '$(XMLPROC)')
</I>&gt;<i> - &#160; &#160; &#160; rm -rf build
</I>&gt;<i> + &#160; &#160; &#160; rm -rf $(abs_builddir)/build
</I>&gt;<i> &#160; &#160; &#160; &#160;rm -f gps/*.so gps/*.pyc stamp-python*.tmp
</I>&gt;<i> &#160; &#160; &#160; &#160;for i in $(PYTHONSCRIPTS_DIST); do rm -f $${i}c; done
</I>&gt;<i> &#160;endif
</I>&gt;<i> @@ -394,11 +394,18 @@ if HAVE_PYTHON
</I>&gt;<i> &#160;# Make sure we do not use --root as option to setup.py install
</I>&gt;<i> &#160;# when DESTDIR is not defined as distutils would use the current
</I>&gt;<i> &#160;# working directory as root directory and not install to ${prefix}.
</I>&gt;<i> - &#160; &#160; &#160; if test -z &quot;$(DESTDIR)&quot;; then \
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160; &#160; env version='$(PACKAGE_VERSION)' MAKE=$(MAKE) $(PYTHON) setup.py install --prefix=${prefix} ;\
</I>&gt;<i> - &#160; &#160; &#160; else \
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160; &#160; env version='$(PACKAGE_VERSION)' MAKE=$(MAKE) $(PYTHON) setup.py install --prefix=${prefix} --root=$(DESTDIR) ;\
</I>&gt;<i> - &#160; &#160; &#160; fi
</I>&gt;<i> + &#160; &#160; &#160; if test -z &quot;$(DESTDIR)&quot;; then extra_opts=&quot;--root=$(DESTDIR)&quot;; fi ;\
</I>&gt;<i> + &#160; &#160; &#160; env version='$(PACKAGE_VERSION)' MAKE=$(MAKE) \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; $(PYTHON) setup.py install_lib \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --prefix=${prefix} \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-dir='$(abs_builddir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; $$extra_opts ;\
</I>&gt;<i> + &#160; &#160; &#160; env version='$(PACKAGE_VERSION)' MAKE=$(MAKE) \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; $(PYTHON) setup.py install_scripts \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --prefix=${prefix} \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; --build-dir='$(abs_builddir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; $$extra_opts
</I>&gt;<i> +
</I>&gt;<i> &#160;endif
</I>&gt;<i> &#160;if LIB_Q_GPSMM_ENABLE
</I>&gt;<i> &#160; &#160; &#160; &#160;$(MAKE) -C libQgpsmm install INSTALL_ROOT=$(DESTDIR)
</I>&gt;<i> @@ -832,7 +839,7 @@ bits-regress: test_bits
</I>&gt;<i>
</I>&gt;<i> &#160;python-indentation-regress:
</I>&gt;<i> &#160; &#160; &#160; &#160;set -e; for pyfile in $(PYTHONSCRIPTS_DIST) $(PYTHONMODULES_DIST); do \
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160; &#160; $(PYTHON) -tt -m py_compile $$pyfile ;\
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; $(PYTHON) -tt -m py_compile $(srcdir)/$$pyfile ;\
</I>&gt;<i> &#160; &#160; &#160; &#160;done
</I>&gt;<i>
</I>&gt;<i> &#160;# Do all normal regression tests.
</I>&gt;<i> diff --git a/setup.py b/setup.py
</I>&gt;<i> old mode 100644
</I>&gt;<i> new mode 100755
</I>&gt;<i> index 3c8ee3d..bf0e380
</I>&gt;<i> --- a/setup.py
</I>&gt;<i> +++ b/setup.py
</I>&gt;<i> @@ -1,12 +1,17 @@
</I>&gt;<i> +#!/usr/bin/python
</I>&gt;<i> &#160;# This file is Copyright (c) 2010 by the GPSD project
</I>&gt;<i> &#160;# BSD terms apply: see the file COPYING in the distribution root for details.
</I>&gt;<i> &#160;#
</I>&gt;<i> &#160;# Creates build/lib.linux-${arch}-${pyvers}/gpspacket.so,
</I>&gt;<i> &#160;# where ${arch} is an architecture and ${pyvers} is a Python version.
</I>&gt;<i>
</I>&gt;<i> -from distutils.core import setup, Extension
</I>&gt;<i> +try:
</I>&gt;<i> + &#160; &#160;from setuptools import setup, Extension
</I>&gt;<i> +except ImportError:
</I>&gt;<i> + &#160; &#160;from distutils.core import setup, Extension
</I>&gt;<i>
</I>&gt;<i> &#160;import os
</I>&gt;<i> +import re
</I>&gt;<i> &#160;import sys
</I>&gt;<i>
</I>&gt;<i> &#160;# For VPATH builds, this script must be run from $(srcdir) with the
</I>&gt;<i> @@ -14,11 +19,52 @@ import sys
</I>&gt;<i> &#160;# directory. &#160;This is necessary because Python's distutils package
</I>&gt;<i> &#160;# does not have built-in support for VPATH builds.
</I>&gt;<i>
</I>&gt;<i> +MAKE = os.getenv('MAKE', &quot;make&quot;)
</I>&gt;<i> +abs_builddir = os.getenv(&quot;abs_builddir&quot;, os.curdir)
</I>&gt;<i> +
</I>&gt;<i> &#160;# These dependencies are enforced here and not in the Makefile to make
</I>&gt;<i> &#160;# it easier to build the Python parts without building everything else
</I>&gt;<i> &#160;# (the user can run 'python setup.py' without having to run 'make').
</I>&gt;<i> &#160;needed_files = ['gpsd.h', 'packet_names.h']
</I>&gt;<i> -created_files = []
</I>&gt;<i> +
</I>&gt;<i> +# Sources and include directories
</I>&gt;<i> +gpspacket_sources = [&quot;gpspacket.c&quot;, &quot;packet.c&quot;, &quot;isgps.c&quot;,
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160;&quot;driver_rtcm2.c&quot;, &quot;strl.c&quot;, &quot;hex.c&quot;, &quot;crc24q.c&quot;]
</I>&gt;<i> +include_dirs = [ os.path.realpath(os.path.dirname(__file__)),
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; abs_builddir]
</I>&gt;<i> +
</I>&gt;<i> +def make(f_name):
</I>&gt;<i> + &#160; &#160;cmd = &quot;%s -C %s %s&quot; %(MAKE, abs_builddir, f_name)
</I>&gt;<i> + &#160; &#160;print(cmd)
</I>&gt;<i> + &#160; &#160;make_cmd = os.popen(cmd)
</I>&gt;<i> + &#160; &#160;make_out = make_cmd.read()
</I>&gt;<i> + &#160; &#160;print(make_out)
</I>&gt;<i> + &#160; &#160;if make_cmd.close():
</I>&gt;<i> + &#160; &#160; &#160; &#160;sys.exit(1)
</I>&gt;<i> + &#160; &#160;return make_out
</I>&gt;<i> +
</I>&gt;<i> +
</I>&gt;<i> +version = os.getenv('version', None) or re.findall(r'^[0-9].*', make('version'), re.M)[0]
</I>&gt;<i> +
</I>&gt;<i> +if not 'clean' in sys.argv:
</I>&gt;<i> + &#160; &#160;# Ensure we have a properly configured environment if not being called
</I>&gt;<i> + &#160; &#160;# from make.
</I>&gt;<i> + &#160; &#160;if not os.getenv('MAKE', None):
</I>&gt;<i> + &#160; &#160; &#160; &#160;if not os.path.exists(os.path.join(abs_builddir, 'Makefile')):
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160;sys.stderr.write('\nPlease run configure first!\n')
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160;sys.exit(1)
</I>&gt;<i> + &#160; &#160; &#160; &#160;else:
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160;make('Makefile')
</I>&gt;<i> + &#160; &#160;if not os.path.exists(os.path.join(abs_builddir, 'gpsd_config.h')):
</I>&gt;<i> + &#160; &#160; &#160; &#160;sys.stderr.write('\nPlease run configure first!\n')
</I>&gt;<i> + &#160; &#160; &#160; &#160;sys.exit(1)
</I>&gt;<i> +
</I>&gt;<i> + &#160; &#160;for f_name in needed_files:
</I>&gt;<i> + &#160; &#160; &#160; &#160;# TODO: &#160;Shouldn't make be run unconditionally in case a
</I>&gt;<i> + &#160; &#160; &#160; &#160;# dependency of f_name has been updated?
</I>&gt;<i> + &#160; &#160; &#160; &#160;if not os.path.exists(os.path.join(abs_builddir, f_name)):
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160;make(f_name)
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> &#160;manpages = []
</I>&gt;<i> &#160;try:
</I>&gt;<i> @@ -34,33 +80,12 @@ except ValueError:
</I>&gt;<i> &#160;if not manpages:
</I>&gt;<i> &#160; &#160; print(&quot;No XML processor, omitting manual-page installation.&quot;)
</I>&gt;<i>
</I>&gt;<i> -MAKE = (&quot;MAKE&quot; in os.environ) and os.environ[&quot;MAKE&quot;] or &quot;make&quot;
</I>&gt;<i> -abs_builddir = (&quot;abs_builddir&quot; in os.environ) and os.environ[&quot;abs_builddir&quot;] or &quot;&quot;
</I>&gt;<i> -if not 'clean' in sys.argv:
</I>&gt;<i> - &#160; &#160;if not os.path.exists(os.path.join(abs_builddir, 'gpsd_config.h')):
</I>&gt;<i> - &#160; &#160; &#160; &#160;sys.stderr.write('\nPlease run configure first!\n')
</I>&gt;<i> - &#160; &#160; &#160; &#160;sys.exit(1)
</I>&gt;<i>
</I>&gt;<i> - &#160; &#160;cdcmd = abs_builddir and (&quot;cd '&quot; + abs_builddir + &quot;' &amp;&amp; &quot;) or &quot;&quot;
</I>&gt;<i> - &#160; &#160;for f_name in needed_files:
</I>&gt;<i> - &#160; &#160; &#160; &#160;# TODO: &#160;Shouldn't make be run unconditionally in case a
</I>&gt;<i> - &#160; &#160; &#160; &#160;# dependency of f_name has been updated?
</I>&gt;<i> - &#160; &#160; &#160; &#160;if not os.path.exists(os.path.join(abs_builddir, f_name)):
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160;cmd = cdcmd + MAKE + &quot; '&quot; + f_name + &quot;'&quot;
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160;print(cmd)
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160;make_out = os.popen(cmd)
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160;print(make_out.read())
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160;if make_out.close():
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sys.exit(1)
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160;created_files.append(f_name)
</I>&gt;<i>
</I>&gt;<i> -gpspacket_sources = [&quot;gpspacket.c&quot;, &quot;packet.c&quot;, &quot;isgps.c&quot;,
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160;&quot;driver_rtcm2.c&quot;, &quot;strl.c&quot;, &quot;hex.c&quot;, &quot;crc24q.c&quot;]
</I>&gt;<i> -include_dirs = [ os.path.realpath(os.path.dirname(__file__)),
</I>&gt;<i> - &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; abs_builddir or &quot;.&quot;]
</I>&gt;<i> +
</I>&gt;<i>
</I>&gt;<i> &#160;setup( name=&quot;gps&quot;,
</I>&gt;<i> - &#160; &#160; &#160; version=os.environ['version'],
</I>&gt;<i> + &#160; &#160; &#160; version=version,
</I>&gt;<i> &#160; &#160; &#160; &#160;description='Python libraries for the gpsd service daemon',
</I>&gt;<i> &#160; &#160; &#160; &#160;url=&quot;<A HREF="http://gpsd.berlios.de/">http://gpsd.berlios.de/</A>&quot;,
</I>&gt;<i> &#160; &#160; &#160; &#160;author='the GPSD project',
</I>&gt;<i>
</I>&gt;<i> commit 25c5f8a12955e145a25a4c532240eb8557b1ae86
</I>&gt;<i> Author: Bernd Zeimetz &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">bernd at bzed.de</A>&gt;
</I>&gt;<i> Date: &#160; Wed Mar 9 22:35:40 2011 +0100
</I>&gt;<i>
</I>&gt;<i> &#160; &#160;Fix out-of-src-sirectory builds for libQgpsmm.
</I>&gt;<i>
</I>&gt;<i> &#160; &#160;unfortunately still not a 100% fix as the build still happens in $srcdir.
</I>&gt;<i>
</I>&gt;<i> diff --git a/Makefile.am b/Makefile.am
</I>&gt;<i> index 5b2a2b8..0a88c95 100644
</I>&gt;<i> --- a/Makefile.am
</I>&gt;<i> +++ b/Makefile.am
</I>&gt;<i> @@ -347,6 +347,7 @@ QTLIB_sources = gpsutils.c \
</I>&gt;<i>
</I>&gt;<i> &#160;QMAKE_OPTS = &quot;PREFIX=${prefix}&quot; \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &quot;MAKE=$(MAKE)&quot; \
</I>&gt;<i> + &#160; &#160; &#160; &#160; &#160; &#160; &quot;ABS_BUILDDIR=`cd $(abs_builddir); pwd`&quot; \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &quot;QMAKE_CXX=$(CXX)&quot; \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &quot;QMAKE_CC=$(CC)&quot; \
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &quot;QMAKE_CFLAGS+=$(CFLAGS)&quot; \
</I>&gt;<i> diff --git a/libQgpsmm/libQgpsmm.pro b/libQgpsmm/libQgpsmm.pro
</I>&gt;<i> index fea8d64..1df5615 100644
</I>&gt;<i> --- a/libQgpsmm/libQgpsmm.pro
</I>&gt;<i> +++ b/libQgpsmm/libQgpsmm.pro
</I>&gt;<i> @@ -15,6 +15,7 @@ isEmpty( MAKE ) {
</I>&gt;<i> &#160; &#160; MAKE = make
</I>&gt;<i> &#160;}
</I>&gt;<i>
</I>&gt;<i> +
</I>&gt;<i> &#160;SOURCES += \
</I>&gt;<i> &#160; &#160; gpsutils.cpp \
</I>&gt;<i> &#160; &#160; libgps_core.cpp \
</I>&gt;<i> @@ -34,12 +35,17 @@ HEADERS += libQgpsmm_global.h \
</I>&gt;<i>
</I>&gt;<i> &#160;!win32 {
</I>&gt;<i>
</I>&gt;<i> + &#160; &#160;isEmpty( ABS_BUILDDIR ) {
</I>&gt;<i> + &#160; &#160; &#160; &#160;ABS_BUILDDIR = ..
</I>&gt;<i> + &#160; &#160;}
</I>&gt;<i> + &#160; &#160;INCLUDEPATH += $${ABS_BUILDDIR}
</I>&gt;<i> +
</I>&gt;<i> &#160; &#160; isEmpty( VERSION ) {
</I>&gt;<i> &#160; &#160; &#160; &#160; VERSION = $$system($${MAKE} -s -C .. print_libgps_VERSION)
</I>&gt;<i> &#160; &#160; }
</I>&gt;<i> &#160; &#160; HEADERS += \
</I>&gt;<i> - &#160; &#160; &#160; &#160;../gpsd.h \
</I>&gt;<i> - &#160; &#160; &#160; ../ais_json.i
</I>&gt;<i> + &#160; &#160; &#160; &#160;$${ABS_BUILDDIR}/gpsd.h \
</I>&gt;<i> + &#160; &#160; &#160; $${ABS_BUILDDIR}/ais_json.i
</I>&gt;<i>
</I>&gt;<i> &#160; &#160; # Prefix: base instalation directory
</I>&gt;<i> &#160; &#160; isEmpty( PREFIX ) {
</I>&gt;<i>
</I>&gt;<i> commit fa1d43dcc15e721bff471d9ac7cb75f92a188303
</I>&gt;<i> Author: Bernd Zeimetz &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">bernd at bzed.de</A>&gt;
</I>&gt;<i> Date: &#160; Wed Mar 9 22:33:05 2011 +0100
</I>&gt;<i>
</I>&gt;<i> &#160; &#160;Very very ugly workaround to depend ensure that gpsd.h exists.
</I>&gt;<i>
</I>&gt;<i> &#160; &#160;Unfortunately parallel build never worked due to a missing dependency on gpsd.h which could not be fixed due to autotools/automake weirdness. Don't hesitate to revert this commit if it breaks anything.
</I>&gt;<i>
</I>&gt;<i> diff --git a/Makefile.am b/Makefile.am
</I>&gt;<i> index 1928faa..5b2a2b8 100644
</I>&gt;<i> --- a/Makefile.am
</I>&gt;<i> +++ b/Makefile.am
</I>&gt;<i> @@ -166,6 +166,9 @@ libgps_c_sources = \
</I>&gt;<i> &#160; &#160; &#160; &#160;shared_json.c \
</I>&gt;<i> &#160; &#160; &#160; &#160;strl.c
</I>&gt;<i>
</I>&gt;<i> +$(srcdir)/gpsutils.c: gpsd.h
</I>&gt;<i> + &#160; &#160; &#160; touch $@
</I>&gt;<i> +
</I>&gt;<i> &#160;if NO_DAEMON3
</I>&gt;<i> &#160;libgps_c_sources += daemon.c
</I>&gt;<i> &#160;endif
</I>&gt;<i>
</I>&gt;<i> -----------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Summary of changes:
</I>&gt;<i> &#160;Makefile.am &#160; &#160; &#160; &#160; &#160; &#160; | &#160; 37 +++++++++++++++--------
</I>&gt;<i> &#160;libQgpsmm/libQgpsmm.pro | &#160; 10 +++++-
</I>&gt;<i> &#160;setup.py &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;| &#160; 75 +++++++++++++++++++++++++++++++---------------
</I>&gt;<i> &#160;3 files changed, 82 insertions(+), 40 deletions(-)
</I>&gt;<i> &#160;mode change 100644 =&gt; 100755 setup.py
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> hooks/post-receive
</I>&gt;<i> --
</I>&gt;<i> Project gpsd at BerliOS
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Gpsd-commit-watch mailing list
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">Gpsd-commit-watch at lists.berlios.de</A>
</I>&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-commit-watch">https://lists.berlios.de/mailman/listinfo/gpsd-commit-watch</A>
</I>&gt;<i>
</I>


-- 
GDB has a 'break' feature; why doesn't it have 'fix' too?

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008788.html">[Gpsd-dev] Breaking up the packet sniffer
</A></li>
	<LI>Next message: <A HREF="008798.html">[Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8790">[ date ]</a>
              <a href="thread.html#8790">[ thread ]</a>
              <a href="subject.html#8790">[ subject ]</a>
              <a href="author.html#8790">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/gpsd-dev">More information about the Gpsd-dev
mailing list</a><br>
</body></html>
