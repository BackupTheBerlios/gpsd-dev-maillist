<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/gpsd-dev/2011-March/index.html" >
   <LINK REL="made" HREF="mailto:gpsd-dev%40lists.berlios.de?Subject=Re%3A%20%5BGpsd-dev%5D%20%5BGpsd-commit-watch%5D%20Project%20gpsd%20at%20BerliOS%20branch%2C%0A%20master%2C%20updated.%20release-2.95-1015-g299c211&In-Reply-To=%3C4D7BDD71.3060005%40bzed.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="008790.html">
   <LINK REL="Next"  HREF="008800.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211</H1>
    <B>Bernd Zeimetz</B> 
    <A HREF="mailto:gpsd-dev%40lists.berlios.de?Subject=Re%3A%20%5BGpsd-dev%5D%20%5BGpsd-commit-watch%5D%20Project%20gpsd%20at%20BerliOS%20branch%2C%0A%20master%2C%20updated.%20release-2.95-1015-g299c211&In-Reply-To=%3C4D7BDD71.3060005%40bzed.de%3E"
       TITLE="[Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211">bernd at bzed.de
       </A><BR>
    <I>Sat Mar 12 21:54:09 CET 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="008790.html">[Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211
</A></li>
        <LI>Next message: <A HREF="008800.html">[Gpsd-dev] make dist-rpm testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8798">[ date ]</a>
              <a href="thread.html#8798">[ thread ]</a>
              <a href="subject.html#8798">[ subject ]</a>
              <a href="author.html#8798">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please
- git pull
- send a full build log.

thanks,

Bernd

On 03/12/2011 12:39 AM, Chris Kuethe wrote:
&gt;<i> according to git bisect, this commit breaks my build.
</I>&gt;<i> 
</I>&gt;<i> gpspacket.c:8:20: error: Python.h: No such file or directory
</I>&gt;<i> gpspacket.c:13: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before '*' token
</I>&gt;<i> gpspacket.c:15: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before '*' token
</I>&gt;<i> gpspacket.c: In function 'gpsd_report':
</I>&gt;<i> gpspacket.c:20: error: 'PyObject' undeclared (first use in this function)
</I>&gt;<i> gpspacket.c:20: error: (Each undeclared identifier is reported only once
</I>&gt;<i> gpspacket.c:20: error: for each function it appears in.)
</I>&gt;<i> gpspacket.c:20: error: 'args' undeclared (first use in this function)
</I>&gt;<i> gpspacket.c:21: error: 'va_list' undeclared (first use in this function)
</I>&gt;<i> gpspacket.c:21: error: expected ';' before 'ap'
</I>&gt;<i> gpspacket.c:25: error: 'report_callback' undeclared (first use in this function)
</I>&gt;<i> gpspacket.c:29: error: 'ErrorObject' undeclared (first use in this function)
</I>&gt;<i> gpspacket.c:33: error: 'ap' undeclared (first use in this function)
</I>&gt;<i> gpspacket.c: At top level:
</I>&gt;<i> gpspacket.c:45: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before 'Lexer_Type'
</I>&gt;<i> gpspacket.c:48: error: expected specifier-qualifier-list before 'PyObject_HEAD'
</I>&gt;<i> gpspacket.c:53: error: expected ')' before '*' token
</I>&gt;<i> gpspacket.c: In function 'Lexer_init':
</I>&gt;<i> gpspacket.c:69: error: 'LexerObject' has no member named 'lexer'
</I>&gt;<i> gpspacket.c: At top level:
</I>&gt;<i> gpspacket.c:73: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before '*' token
</I>&gt;<i> gpspacket.c:94: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before '*' token
</I>&gt;<i> gpspacket.c:109: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before 'Lexer_methods'
</I>&gt;<i> gpspacket.c:117: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before '*' token
</I>&gt;<i> gpspacket.c:124: error: expected ')' before string constant
</I>&gt;<i> gpspacket.c:128: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before 'Lexer_Type'
</I>&gt;<i> gpspacket.c:177: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before '*' token
</I>&gt;<i> gpspacket.c:191: error: expected ')' before string constant
</I>&gt;<i> gpspacket.c:195: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before '*' token
</I>&gt;<i> gpspacket.c:223: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before 'packet_methods'
</I>&gt;<i> gpspacket.c:232: error: expected ')' before string constant
</I>&gt;<i> gpspacket.c:245: error: expected '=', ',', ';', 'asm' or
</I>&gt;<i> '__attribute__' before 'initpacket'
</I>&gt;<i> error: command 'cc' failed with exit status 1
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Wed, Mar 9, 2011 at 13:38, bzed at BerliOS &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">gpsd-dev at lists.berlios.de</A>&gt; wrote:
</I>&gt;&gt;<i> This is an automated email from the git hooks/post-receive script. It was
</I>&gt;&gt;<i> generated because a ref change was pushed to the repository containing
</I>&gt;&gt;<i> the project &quot;Project gpsd at BerliOS&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The branch, master has been updated
</I>&gt;&gt;<i>       via  299c211ee46e378c9110f7f7a75d42240af03a47 (commit)
</I>&gt;&gt;<i>       via  25c5f8a12955e145a25a4c532240eb8557b1ae86 (commit)
</I>&gt;&gt;<i>       via  fa1d43dcc15e721bff471d9ac7cb75f92a188303 (commit)
</I>&gt;&gt;<i>      from  2ad88823a86d5c5bda8a6741e7a186762c7f5c30 (commit)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Those revisions listed above that are new to this repository have
</I>&gt;&gt;<i> not appeared on any other notification email; so we list those
</I>&gt;&gt;<i> revisions in full, below.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - Log -----------------------------------------------------------------
</I>&gt;&gt;<i> commit 299c211ee46e378c9110f7f7a75d42240af03a47
</I>&gt;&gt;<i> Author: Bernd Zeimetz &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">bernd at bzed.de</A>&gt;
</I>&gt;&gt;<i> Date:   Wed Mar 9 22:36:26 2011 +0100
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Fix out-of-src-directory builds for python.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Also ensure that `version` is uptodate in setup.py.
</I>&gt;&gt;<i>    Running `make testregress` still does not work properly if run outside of $srcdir, but at least it runs now.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> diff --git a/Makefile.am b/Makefile.am
</I>&gt;&gt;<i> index 0a88c95..022fa65a 100644
</I>&gt;&gt;<i> --- a/Makefile.am
</I>&gt;&gt;<i> +++ b/Makefile.am
</I>&gt;&gt;<i> @@ -288,7 +288,7 @@ noinst_SCRIPTS += stamp-python setup.py
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  # TODO:  Should the dependency on libgps.la be enforced inside
</I>&gt;&gt;<i>  # setup.py?  (See the variable 'needed_files' in setup.py.)
</I>&gt;&gt;<i> -stamp-python: gpspacket.c gpsclient.c libgps.la setup.py $(PYTHONMODULES_DIST) $(PYTHONSCRIPTS_DIST)
</I>&gt;&gt;<i> +stamp-python: gpspacket.c gpsclient.c libgps.la gpsd.h setup.py $(PYTHONMODULES_DIST) $(PYTHONSCRIPTS_DIST)
</I>&gt;&gt;<i>  # Build Python modules and scripts using distutils via setup.py.
</I>&gt;&gt;<i>  # We define build-lib and build-scripts as distutils might have been
</I>&gt;&gt;<i>  # configured to use different directories, but we want to use the
</I>&gt;&gt;<i> @@ -302,12 +302,12 @@ stamp-python: gpspacket.c gpsclient.c libgps.la setup.py $(PYTHONMODULES_DIST) $
</I>&gt;&gt;<i>        env version='$(PACKAGE_VERSION)' abs_builddir='$(abs_builddir)' \
</I>&gt;&gt;<i>            MAKE='$(MAKE)' \
</I>&gt;&gt;<i>                $(PYTHON) setup.py build \
</I>&gt;&gt;<i> -                       --build-lib '$(srcdir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;&gt;<i> -                       --build-scripts '$(srcdir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;&gt;<i> +                       --build-lib '$(abs_builddir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;&gt;<i> +                       --build-scripts '$(abs_builddir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;&gt;<i>                        --mangenerator '$(XMLPROC)') &amp;&amp; \
</I>&gt;&gt;<i>        (cd '$(srcdir)/gps' &amp;&amp; \
</I>&gt;&gt;<i>            rm -f *.so &amp;&amp; \
</I>&gt;&gt;<i> -           ln -s ../$(PYTHON_DISTUTILS_LIBDIR)/gps/*.so . ) &amp;&amp; \
</I>&gt;&gt;<i> +           ln -s $(abs_builddir)/$(PYTHON_DISTUTILS_LIBDIR)/gps/*.so . ) &amp;&amp; \
</I>&gt;&gt;<i>        mv -f '$@.tmp' '$@'
</I>&gt;&gt;<i>  CLEANFILES += stamp-python stamp-python.tmp
</I>&gt;&gt;<i>  endif
</I>&gt;&gt;<i> @@ -373,10 +373,10 @@ if HAVE_PYTHON
</I>&gt;&gt;<i>        env version='$(PACKAGE_VERSION)' abs_builddir='$(abs_builddir)' \
</I>&gt;&gt;<i>            MAKE='$(MAKE)' \
</I>&gt;&gt;<i>                $(PYTHON) setup.py clean \
</I>&gt;&gt;<i> -                       --build-lib '$(srcdir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;&gt;<i> -                       --build-scripts '$(srcdir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;&gt;<i> +                       --build-lib '$(abs_builddir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;&gt;<i> +                       --build-scripts '$(abs_builddir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;&gt;<i>                        --mangenerator '$(XMLPROC)')
</I>&gt;&gt;<i> -       rm -rf build
</I>&gt;&gt;<i> +       rm -rf $(abs_builddir)/build
</I>&gt;&gt;<i>        rm -f gps/*.so gps/*.pyc stamp-python*.tmp
</I>&gt;&gt;<i>        for i in $(PYTHONSCRIPTS_DIST); do rm -f $${i}c; done
</I>&gt;&gt;<i>  endif
</I>&gt;&gt;<i> @@ -394,11 +394,18 @@ if HAVE_PYTHON
</I>&gt;&gt;<i>  # Make sure we do not use --root as option to setup.py install
</I>&gt;&gt;<i>  # when DESTDIR is not defined as distutils would use the current
</I>&gt;&gt;<i>  # working directory as root directory and not install to ${prefix}.
</I>&gt;&gt;<i> -       if test -z &quot;$(DESTDIR)&quot;; then \
</I>&gt;&gt;<i> -               env version='$(PACKAGE_VERSION)' MAKE=$(MAKE) $(PYTHON) setup.py install --prefix=${prefix} ;\
</I>&gt;&gt;<i> -       else \
</I>&gt;&gt;<i> -               env version='$(PACKAGE_VERSION)' MAKE=$(MAKE) $(PYTHON) setup.py install --prefix=${prefix} --root=$(DESTDIR) ;\
</I>&gt;&gt;<i> -       fi
</I>&gt;&gt;<i> +       if test -z &quot;$(DESTDIR)&quot;; then extra_opts=&quot;--root=$(DESTDIR)&quot;; fi ;\
</I>&gt;&gt;<i> +       env version='$(PACKAGE_VERSION)' MAKE=$(MAKE) \
</I>&gt;&gt;<i> +               $(PYTHON) setup.py install_lib \
</I>&gt;&gt;<i> +                       --prefix=${prefix} \
</I>&gt;&gt;<i> +                       --build-dir='$(abs_builddir)/$(PYTHON_DISTUTILS_LIBDIR)' \
</I>&gt;&gt;<i> +                       $$extra_opts ;\
</I>&gt;&gt;<i> +       env version='$(PACKAGE_VERSION)' MAKE=$(MAKE) \
</I>&gt;&gt;<i> +               $(PYTHON) setup.py install_scripts \
</I>&gt;&gt;<i> +                       --prefix=${prefix} \
</I>&gt;&gt;<i> +                       --build-dir='$(abs_builddir)/$(PYTHON_DISTUTILS_SCRIPTDIR)' \
</I>&gt;&gt;<i> +                       $$extra_opts
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i>  endif
</I>&gt;&gt;<i>  if LIB_Q_GPSMM_ENABLE
</I>&gt;&gt;<i>        $(MAKE) -C libQgpsmm install INSTALL_ROOT=$(DESTDIR)
</I>&gt;&gt;<i> @@ -832,7 +839,7 @@ bits-regress: test_bits
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  python-indentation-regress:
</I>&gt;&gt;<i>        set -e; for pyfile in $(PYTHONSCRIPTS_DIST) $(PYTHONMODULES_DIST); do \
</I>&gt;&gt;<i> -               $(PYTHON) -tt -m py_compile $$pyfile ;\
</I>&gt;&gt;<i> +               $(PYTHON) -tt -m py_compile $(srcdir)/$$pyfile ;\
</I>&gt;&gt;<i>        done
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  # Do all normal regression tests.
</I>&gt;&gt;<i> diff --git a/setup.py b/setup.py
</I>&gt;&gt;<i> old mode 100644
</I>&gt;&gt;<i> new mode 100755
</I>&gt;&gt;<i> index 3c8ee3d..bf0e380
</I>&gt;&gt;<i> --- a/setup.py
</I>&gt;&gt;<i> +++ b/setup.py
</I>&gt;&gt;<i> @@ -1,12 +1,17 @@
</I>&gt;&gt;<i> +#!/usr/bin/python
</I>&gt;&gt;<i>  # This file is Copyright (c) 2010 by the GPSD project
</I>&gt;&gt;<i>  # BSD terms apply: see the file COPYING in the distribution root for details.
</I>&gt;&gt;<i>  #
</I>&gt;&gt;<i>  # Creates build/lib.linux-${arch}-${pyvers}/gpspacket.so,
</I>&gt;&gt;<i>  # where ${arch} is an architecture and ${pyvers} is a Python version.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -from distutils.core import setup, Extension
</I>&gt;&gt;<i> +try:
</I>&gt;&gt;<i> +    from setuptools import setup, Extension
</I>&gt;&gt;<i> +except ImportError:
</I>&gt;&gt;<i> +    from distutils.core import setup, Extension
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  import os
</I>&gt;&gt;<i> +import re
</I>&gt;&gt;<i>  import sys
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  # For VPATH builds, this script must be run from $(srcdir) with the
</I>&gt;&gt;<i> @@ -14,11 +19,52 @@ import sys
</I>&gt;&gt;<i>  # directory.  This is necessary because Python's distutils package
</I>&gt;&gt;<i>  # does not have built-in support for VPATH builds.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> +MAKE = os.getenv('MAKE', &quot;make&quot;)
</I>&gt;&gt;<i> +abs_builddir = os.getenv(&quot;abs_builddir&quot;, os.curdir)
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i>  # These dependencies are enforced here and not in the Makefile to make
</I>&gt;&gt;<i>  # it easier to build the Python parts without building everything else
</I>&gt;&gt;<i>  # (the user can run 'python setup.py' without having to run 'make').
</I>&gt;&gt;<i>  needed_files = ['gpsd.h', 'packet_names.h']
</I>&gt;&gt;<i> -created_files = []
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i> +# Sources and include directories
</I>&gt;&gt;<i> +gpspacket_sources = [&quot;gpspacket.c&quot;, &quot;packet.c&quot;, &quot;isgps.c&quot;,
</I>&gt;&gt;<i> +            &quot;driver_rtcm2.c&quot;, &quot;strl.c&quot;, &quot;hex.c&quot;, &quot;crc24q.c&quot;]
</I>&gt;&gt;<i> +include_dirs = [ os.path.realpath(os.path.dirname(__file__)),
</I>&gt;&gt;<i> +                 abs_builddir]
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i> +def make(f_name):
</I>&gt;&gt;<i> +    cmd = &quot;%s -C %s %s&quot; %(MAKE, abs_builddir, f_name)
</I>&gt;&gt;<i> +    print(cmd)
</I>&gt;&gt;<i> +    make_cmd = os.popen(cmd)
</I>&gt;&gt;<i> +    make_out = make_cmd.read()
</I>&gt;&gt;<i> +    print(make_out)
</I>&gt;&gt;<i> +    if make_cmd.close():
</I>&gt;&gt;<i> +        sys.exit(1)
</I>&gt;&gt;<i> +    return make_out
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i> +version = os.getenv('version', None) or re.findall(r'^[0-9].*', make('version'), re.M)[0]
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i> +if not 'clean' in sys.argv:
</I>&gt;&gt;<i> +    # Ensure we have a properly configured environment if not being called
</I>&gt;&gt;<i> +    # from make.
</I>&gt;&gt;<i> +    if not os.getenv('MAKE', None):
</I>&gt;&gt;<i> +        if not os.path.exists(os.path.join(abs_builddir, 'Makefile')):
</I>&gt;&gt;<i> +            sys.stderr.write('\nPlease run configure first!\n')
</I>&gt;&gt;<i> +            sys.exit(1)
</I>&gt;&gt;<i> +        else:
</I>&gt;&gt;<i> +            make('Makefile')
</I>&gt;&gt;<i> +    if not os.path.exists(os.path.join(abs_builddir, 'gpsd_config.h')):
</I>&gt;&gt;<i> +        sys.stderr.write('\nPlease run configure first!\n')
</I>&gt;&gt;<i> +        sys.exit(1)
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i> +    for f_name in needed_files:
</I>&gt;&gt;<i> +        # TODO:  Shouldn't make be run unconditionally in case a
</I>&gt;&gt;<i> +        # dependency of f_name has been updated?
</I>&gt;&gt;<i> +        if not os.path.exists(os.path.join(abs_builddir, f_name)):
</I>&gt;&gt;<i> +            make(f_name)
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  manpages = []
</I>&gt;&gt;<i>  try:
</I>&gt;&gt;<i> @@ -34,33 +80,12 @@ except ValueError:
</I>&gt;&gt;<i>  if not manpages:
</I>&gt;&gt;<i>     print(&quot;No XML processor, omitting manual-page installation.&quot;)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -MAKE = (&quot;MAKE&quot; in os.environ) and os.environ[&quot;MAKE&quot;] or &quot;make&quot;
</I>&gt;&gt;<i> -abs_builddir = (&quot;abs_builddir&quot; in os.environ) and os.environ[&quot;abs_builddir&quot;] or &quot;&quot;
</I>&gt;&gt;<i> -if not 'clean' in sys.argv:
</I>&gt;&gt;<i> -    if not os.path.exists(os.path.join(abs_builddir, 'gpsd_config.h')):
</I>&gt;&gt;<i> -        sys.stderr.write('\nPlease run configure first!\n')
</I>&gt;&gt;<i> -        sys.exit(1)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -    cdcmd = abs_builddir and (&quot;cd '&quot; + abs_builddir + &quot;' &amp;&amp; &quot;) or &quot;&quot;
</I>&gt;&gt;<i> -    for f_name in needed_files:
</I>&gt;&gt;<i> -        # TODO:  Shouldn't make be run unconditionally in case a
</I>&gt;&gt;<i> -        # dependency of f_name has been updated?
</I>&gt;&gt;<i> -        if not os.path.exists(os.path.join(abs_builddir, f_name)):
</I>&gt;&gt;<i> -            cmd = cdcmd + MAKE + &quot; '&quot; + f_name + &quot;'&quot;
</I>&gt;&gt;<i> -            print(cmd)
</I>&gt;&gt;<i> -            make_out = os.popen(cmd)
</I>&gt;&gt;<i> -            print(make_out.read())
</I>&gt;&gt;<i> -            if make_out.close():
</I>&gt;&gt;<i> -                sys.exit(1)
</I>&gt;&gt;<i> -            created_files.append(f_name)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -gpspacket_sources = [&quot;gpspacket.c&quot;, &quot;packet.c&quot;, &quot;isgps.c&quot;,
</I>&gt;&gt;<i> -            &quot;driver_rtcm2.c&quot;, &quot;strl.c&quot;, &quot;hex.c&quot;, &quot;crc24q.c&quot;]
</I>&gt;&gt;<i> -include_dirs = [ os.path.realpath(os.path.dirname(__file__)),
</I>&gt;&gt;<i> -                 abs_builddir or &quot;.&quot;]
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  setup( name=&quot;gps&quot;,
</I>&gt;&gt;<i> -       version=os.environ['version'],
</I>&gt;&gt;<i> +       version=version,
</I>&gt;&gt;<i>        description='Python libraries for the gpsd service daemon',
</I>&gt;&gt;<i>        url=&quot;<A HREF="http://gpsd.berlios.de/">http://gpsd.berlios.de/</A>&quot;,
</I>&gt;&gt;<i>        author='the GPSD project',
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> commit 25c5f8a12955e145a25a4c532240eb8557b1ae86
</I>&gt;&gt;<i> Author: Bernd Zeimetz &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">bernd at bzed.de</A>&gt;
</I>&gt;&gt;<i> Date:   Wed Mar 9 22:35:40 2011 +0100
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Fix out-of-src-sirectory builds for libQgpsmm.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    unfortunately still not a 100% fix as the build still happens in $srcdir.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> diff --git a/Makefile.am b/Makefile.am
</I>&gt;&gt;<i> index 5b2a2b8..0a88c95 100644
</I>&gt;&gt;<i> --- a/Makefile.am
</I>&gt;&gt;<i> +++ b/Makefile.am
</I>&gt;&gt;<i> @@ -347,6 +347,7 @@ QTLIB_sources = gpsutils.c \
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  QMAKE_OPTS = &quot;PREFIX=${prefix}&quot; \
</I>&gt;&gt;<i>             &quot;MAKE=$(MAKE)&quot; \
</I>&gt;&gt;<i> +             &quot;ABS_BUILDDIR=`cd $(abs_builddir); pwd`&quot; \
</I>&gt;&gt;<i>             &quot;QMAKE_CXX=$(CXX)&quot; \
</I>&gt;&gt;<i>             &quot;QMAKE_CC=$(CC)&quot; \
</I>&gt;&gt;<i>             &quot;QMAKE_CFLAGS+=$(CFLAGS)&quot; \
</I>&gt;&gt;<i> diff --git a/libQgpsmm/libQgpsmm.pro b/libQgpsmm/libQgpsmm.pro
</I>&gt;&gt;<i> index fea8d64..1df5615 100644
</I>&gt;&gt;<i> --- a/libQgpsmm/libQgpsmm.pro
</I>&gt;&gt;<i> +++ b/libQgpsmm/libQgpsmm.pro
</I>&gt;&gt;<i> @@ -15,6 +15,7 @@ isEmpty( MAKE ) {
</I>&gt;&gt;<i>     MAKE = make
</I>&gt;&gt;<i>  }
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i>  SOURCES += \
</I>&gt;&gt;<i>     gpsutils.cpp \
</I>&gt;&gt;<i>     libgps_core.cpp \
</I>&gt;&gt;<i> @@ -34,12 +35,17 @@ HEADERS += libQgpsmm_global.h \
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  !win32 {
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> +    isEmpty( ABS_BUILDDIR ) {
</I>&gt;&gt;<i> +        ABS_BUILDDIR = ..
</I>&gt;&gt;<i> +    }
</I>&gt;&gt;<i> +    INCLUDEPATH += $${ABS_BUILDDIR}
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i>     isEmpty( VERSION ) {
</I>&gt;&gt;<i>         VERSION = $$system($${MAKE} -s -C .. print_libgps_VERSION)
</I>&gt;&gt;<i>     }
</I>&gt;&gt;<i>     HEADERS += \
</I>&gt;&gt;<i> -        ../gpsd.h \
</I>&gt;&gt;<i> -       ../ais_json.i
</I>&gt;&gt;<i> +        $${ABS_BUILDDIR}/gpsd.h \
</I>&gt;&gt;<i> +       $${ABS_BUILDDIR}/ais_json.i
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     # Prefix: base instalation directory
</I>&gt;&gt;<i>     isEmpty( PREFIX ) {
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> commit fa1d43dcc15e721bff471d9ac7cb75f92a188303
</I>&gt;&gt;<i> Author: Bernd Zeimetz &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">bernd at bzed.de</A>&gt;
</I>&gt;&gt;<i> Date:   Wed Mar 9 22:33:05 2011 +0100
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Very very ugly workaround to depend ensure that gpsd.h exists.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>    Unfortunately parallel build never worked due to a missing dependency on gpsd.h which could not be fixed due to autotools/automake weirdness. Don't hesitate to revert this commit if it breaks anything.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> diff --git a/Makefile.am b/Makefile.am
</I>&gt;&gt;<i> index 1928faa..5b2a2b8 100644
</I>&gt;&gt;<i> --- a/Makefile.am
</I>&gt;&gt;<i> +++ b/Makefile.am
</I>&gt;&gt;<i> @@ -166,6 +166,9 @@ libgps_c_sources = \
</I>&gt;&gt;<i>        shared_json.c \
</I>&gt;&gt;<i>        strl.c
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> +$(srcdir)/gpsutils.c: gpsd.h
</I>&gt;&gt;<i> +       touch $@
</I>&gt;&gt;<i> +
</I>&gt;&gt;<i>  if NO_DAEMON3
</I>&gt;&gt;<i>  libgps_c_sources += daemon.c
</I>&gt;&gt;<i>  endif
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -----------------------------------------------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Summary of changes:
</I>&gt;&gt;<i>  Makefile.am             |   37 +++++++++++++++--------
</I>&gt;&gt;<i>  libQgpsmm/libQgpsmm.pro |   10 +++++-
</I>&gt;&gt;<i>  setup.py                |   75 +++++++++++++++++++++++++++++++---------------
</I>&gt;&gt;<i>  3 files changed, 82 insertions(+), 40 deletions(-)
</I>&gt;&gt;<i>  mode change 100644 =&gt; 100755 setup.py
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> hooks/post-receive
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Project gpsd at BerliOS
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Gpsd-commit-watch mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-dev">Gpsd-commit-watch at lists.berlios.de</A>
</I>&gt;&gt;<i> <A HREF="https://lists.berlios.de/mailman/listinfo/gpsd-commit-watch">https://lists.berlios.de/mailman/listinfo/gpsd-commit-watch</A>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>

-- 
 Bernd Zeimetz                            Debian GNU/Linux Developer
 <A HREF="http://bzed.de">http://bzed.de</A>                                <A HREF="http://www.debian.org">http://www.debian.org</A>
 GPG Fingerprint: ECA1 E3F2 8E11 2432 D485  DD95 EB36 171A 6FF9 435F

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="008790.html">[Gpsd-dev] [Gpsd-commit-watch] Project gpsd at BerliOS branch, master, updated. release-2.95-1015-g299c211
</A></li>
	<LI>Next message: <A HREF="008800.html">[Gpsd-dev] make dist-rpm testing
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#8798">[ date ]</a>
              <a href="thread.html#8798">[ thread ]</a>
              <a href="subject.html#8798">[ subject ]</a>
              <a href="author.html#8798">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/gpsd-dev">More information about the Gpsd-dev
mailing list</a><br>
</body></html>
